{"version":3,"sources":["../ES2015/business/strata.js"],"names":["Strata","nature","child","natureFamilyAbbrev","label","dependencies","characteristics","subCharacteristics","childStrata","secondaryComponents","init","i","length","getNature","family","filter","e","secondaryComponentIndex","property","inArrayProperty","c","find","getFamily","getFirstCharacteristicByFamily","splice","clearCharacteristicsFromFamily","getCharacteristicsByFamily","name","exists","getUid","subCharacteristic","push","characteristic","findIndex","replaceCharacteristic","childStratum","uid","elem","split","toUpperCase","undefined","index","dep","reIDep","RegExp","dependency","search","console","log","familyName","characteristicSource","dependencyName","findDependency","Characteristic","updateCharacteristic","characteristicList","cSource","addCharacteristic","subCharacteristicSource","sc","SubCharacteristic","replaceSubCharacteristic","updateSubCharacteristic","strataImage","interfaceImage","addDependency","jsonStrata","interfaces","children","isInterface","getName","toJson","all_component_characteristics","map","concat"],"mappings":"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","file":"strata.js","sourcesContent":["/**\n * Created by Thierry Hubmann\n *\n * Cette classe est développée en ES2015 et est recompilée avec Babel\n * C'est la classe business de la Strate\n */\n\nclass Strata {\n\n    constructor(nature, child) {\n        this.nature = nature;\n        this.natureFamilyAbbrev = null;\n        this.label = null;\n        this.dependencies = [];\n        this.characteristics = [];\n        this.subCharacteristics = [];\n        this.childStrata = [];\n        this.secondaryComponents = [{characteristics: [], subCharacteristics: []}];\n        this.child = child;\n\n        this.init();\n\n\n    }\n\n\n    /**\n     * Retourne une strate enfant de la nature en paramètres\n     * @param nature la nature recherchée\n     * @returns la strate enfant\n     */\n    getChildStrataByNature(nature) {\n\n        for (var i = 0; i < this.childStrata.length; i++) {\n            if (this.childStrata[i].getNature() == nature) {\n                return this.childStrata[i];\n            }\n        }\n        return null;\n    }\n\n\n    /**\n     * Retourne les characteristiques correspondant à la famille donnée en paramètre\n     * @param family la famille recherchée\n     * @returns les characteristiques correspondante\n     */\n    getCharacteristicsByFamily(family) {\n        return this.characteristics.filter(e => e.family == family);\n    }\n\n    getSecondaryComponentCharacteristicsByFamily(family, secondaryComponentIndex=0) {\n        return this.secondaryComponents[secondaryComponentIndex].characteristics.filter(e => e.family == family);\n    }\n\n    /**\n     * Returns either first characteristic with requested family\n     * or its requested property\n     * @param family: characteristics's family searched\n     * @param property: (optional) property of the charasteric object requested\n     * @param inArrayProperty: (optional default to \"characteristics\") Array or name of the Array property in Strata where to search for characteristic\n     * @returns characteristic object / characteristic[property] value\n     */\n    getFirstCharacteristicByFamily(family, property, inArrayProperty=\"characteristics\") {\n        if (typeof(inArrayProperty)==\"string\")\n            inArrayProperty=this[inArrayProperty];\n        let c = inArrayProperty.find(e => e.getFamily() == family);\n        if (!property)\n            return c;\n        else {\n            if (c)\n                return c[property];\n            else\n                return c;\n        }\n    }\n    getFirstSecondaryComponentCharacteristicByFamily(family, property, secondaryComponentIndex=0) {\n        return this.getFirstCharacteristicByFamily(family, property, this.secondaryComponents[secondaryComponentIndex].characteristics)\n    }\n    /**\n     * Returns either first subCharacteristics with requested family\n     * or its requested property\n     * @param family: subCharacteristics's family searched\n     * @param property: (optional) property of the SubCharacteristic object requested\n     * @returns characteristic object / characteristic[property] value\n     */\n    getFirstSubCharacteristicByFamily(family, property) {\n        return this.getFirstCharacteristicByFamily(family, property, this.subCharacteristics);\n    }\n    getFirstSecondaryComponentSubCharacteristicByFamily(family, property,secondaryComponentIndex=0) {\n        return this.getFirstCharacteristicByFamily(family, property, this.secondaryComponents[secondaryComponentIndex].subCharacteristics);\n    }\n\n    /**\n     * Retourne les sous caractéristiques de la famille en paramètre\n     * @param family\n     * @returns {Array} liste de sous caractéristiques\n     */\n    getSubCharacteristicsByFamily(family) {\n        return this.subCharacteristics.filter(e => e.family == family);\n    }\n\n    getSecondaryComponentSubCharacteristicsByFamily(family, secondaryComponentIndex=0) {\n        return this.secondaryComponents[secondaryComponentIndex].subCharacteristics.filter(e => e.family == family);\n    }\n\n    /**\n     * Supprime toutes les characteristiques d'une famille\n     * @param family\n     */\n    clearCharacteristicsFromFamily(family, inArrayProperty ='characteristics') {\n        if (typeof(inArrayProperty)===\"string\")\n            inArrayProperty=this[inArrayProperty];\n        for (var i = 0; i < inArrayProperty.length; i++) {\n            if (inArrayProperty[i].getFamily() == family) {\n                inArrayProperty.splice(i, 1);\n                i--;\n            }\n        }\n    }\n\n    /**\n     * Supprime toutes les sous characteristiques d'une famille\n     * @param family\n     */\n    clearSubCharacteristicsFromFamily(family) {\n       this.clearCharacteristicsFromFamily(family,'subCharacteristics')\n    }\n\n    isFamily(family) {\n        return (this.getCharacteristicsByFamily(family).length > 0);\n    }\n\n    /**\n     * Cette méthode indique si une sous-caracterisitique existe dans une strate.\n     * @param le nom de la sous caracteristique à vérifier\n     * @returns boolean indiquant si la sous-caracteristique existe\n     */\n    isSubCharacteristic(name) {\n        var exists = false;\n        var i = 0;\n        while (exists == false && i < this.subCharacteristics.length) {\n            if (this.subCharacteristics[i].getUid() == name) {\n                exists = true;\n            }\n            i++;\n        }\n        return exists;\n    }\n\n    /**\n     * Ajoute une sous caractéristique sans vérifier si il en existe déjà une pour cette famille\n     * @param subCharacteristic\n     */\n    addSubCharacteristic(subCharacteristic) {\n        this.subCharacteristics.push(subCharacteristic);\n    }\n     /**\n     * Remplace une sous caractéristique de la famille de celle donnée en paramètre\n     * @param characteristic / subcharacteristic\n      * inArrayProperty (\"characteristics\", \"subCharacteristics\", etc..)\n     */\n    replaceCharacteristic(characteristic, inArrayProperty=\"characteristics\") {\n        //todo refactoring switch characteristics and subCharacteristics to Map instead of Array\n        if (typeof(inArrayProperty)===\"string\")\n            inArrayProperty=this[inArrayProperty];\n        var i = inArrayProperty.findIndex(e => e.family == characteristic.family );\n        if (i==-1)\n            inArrayProperty.push(characteristic);\n        else\n            inArrayProperty[i] = characteristic;\n    }\n\n    /**\n     * Remplace une sous caractéristique de la famille de celle donnée en paramètre\n     * @param subCharacteristic\n     */\n    replaceSubCharacteristic(subCharacteristic,inArrayProperty=\"subCharacteristics\") {\n        this.replaceCharacteristic(subCharacteristic, inArrayProperty);\n    }\n\n    addCharacteristic(characteristic,inArrayProperty=\"characteristics\") {\n        if (typeof(inArrayProperty)===\"string\")\n            inArrayProperty=this[inArrayProperty];\n        inArrayProperty.push(characteristic);\n    }\n\n    addChildStrata(childStratum) {\n        this.childStrata.push(childStratum);\n    }\n\n    /**\n     * Permet de savoir si la strate est une strate enfant.\n     * @returns Un booleen qui indique si c'est une strate enfant\n     */\n    isChild() {\n        return this.child;\n    }\n\n    /**\n     * Permet d'indiquer que la strate est une strate enfant\n     * @param child\n     */\n    setChild(child) {\n        this.child = child;\n    }\n\n\n    removeCharacteristic(uid) {\n\n    }\n\n    removeSubCharacteristic(uid) {\n\n    }\n\n    getSubCharacteristics() {\n        return this.subCharacteristics;\n    }\n\n    getCharacteristics() {\n        return this.characteristics;\n    }\n\n\n    getNature() {\n        return this.nature;\n    }\n\n    setNature(nature) {\n        this.nature = nature;\n    }\n\n    /**\n     * Return natureFamily abbreviation (or prefix) of the stratum (e.g. CP for Corrosion products)\n     */\n    getNatureFamilyAbbrev() {\n        if (this.characteristics)\n            this.natureFamilyAbbrev = this.natureFamilyAbbrev || this.characteristics.find(elem => elem.family == \"natureFamily\").name.split(\"Char\")[0].toUpperCase();\n        return this.natureFamilyAbbrev || \"\";\n    }\n\n    /**\n     * setter for label called by Stratigraphy object based on position of stratum in the stratigraphy\n     * and its NatureFamilyAbbrev (e.g: CP2, MC1...)\n     */\n    setLabel(label) {\n        this.label = label;\n    }\n\n    getLabel() {\n        return (this.label);\n    }\n\n    getUid() {\n        return this.uid;\n    }\n\n    setUid(uid) {\n        this.uid = uid;\n    }\n\n    getName() {\n        if (this.name == undefined) {\n            return this.uid;\n        }\n        else {\n            return this.name;\n        }\n    }\n\n    setName(name) {\n        this.name = name;\n    }\n\n    getIndex() {\n        return this.index;\n    }\n\n    setIndex(index) {\n        this.index = index;\n    }\n    addDependency(dep) {\n        this.dependencies.push(dep);\n    }\n    findDependency(dep) {\n        // temp use of case insensitive match before refactoring and using Map instead of list\n        // because of unwanted case differences between Family and dependency key. For ex.\n        // cprimicrostructureaggregatecompositionFamily vs cpriMicrostructureAggregateCompositionFamily\n\n        let reIDep = new RegExp(\"^\" + dep + \"$\", \"i\") ;\n        for (let dependency of this.dependencies) {\n            if (dependency.search(reIDep) == 0)\n            {\n                if (dependency!=dep)\n                    console.log('findDependency('+dep+')='+dependency);\n                return true;\n            }\n\n        }\n        return false;\n    }\n    /**\n     * Helper methods to update stratum Characteristic from controller scope variables\n     * @returns true if characteristic has been updated based on stratum dependency and characteristicSource\n     */\n    updateCharacteristic(familyName, characteristicSource, dependencyName=null, inArrayProperty=\"characteristics\")\n    {\n        dependencyName = dependencyName || familyName; //dependencyName defaults to familyName but could be different\n        if (characteristicSource && this.findDependency(dependencyName)) {\n            let c = new characteristic.Characteristic(familyName, characteristicSource);\n            this.replaceCharacteristic(c, inArrayProperty);\n            return true;\n        }\n        return false;\n    }\n    updateSecondaryComponentCharacteristic(familyName, characteristicSource, dependencyName, secondaryComponentIndex=0)\n    {\n        return this.updateCharacteristic(familyName, characteristicSource, dependencyName, this.secondaryComponents[secondaryComponentIndex].characteristics);\n    }\n\n    updateCharacteristicList(familyName, characteristicList, dependencyName=null,  inArrayProperty=\"characteristics\") {\n        dependencyName = dependencyName || familyName; //dependencyName defaults to familyName but could be different\n        if (typeof(inArrayProperty)===\"string\")\n            inArrayProperty=this[inArrayProperty];\n        if (this.findDependency(familyName)) {\n            this.clearCharacteristicsFromFamily(familyName, inArrayProperty);\n            for (let cSource of characteristicList)\n                this.addCharacteristic(new characteristic.Characteristic(familyName, cSource));\n            return true;\n        }\n        return false;\n    }\n    updateSecondaryComponentCharacteristicList(familyName, characteristicList, dependencyName, secondaryComponentIndex=0){\n        if (this.findDependency(dependencyName)) {\n            this.clearCharacteristicsFromFamily(familyName, this.secondaryComponents[0].characteristics);\n            for (let cSource of characteristicList)\n                this.addCharacteristic(new characteristic.Characteristic(familyName, cSource), this.secondaryComponents[0].characteristics);\n            return true;\n        }\n        return false;\n    }\n\n\n    updateSubCharacteristic(familyName, subCharacteristicSource, dependencyName=null, inArrayProperty=\"subCharacteristics\") {\n        dependencyName = dependencyName || familyName; //dependencyName defaults to familyName but could be different\n        if (subCharacteristicSource && this.findDependency(dependencyName)) {\n            let sc = new subCharacteristic.SubCharacteristic(familyName, subCharacteristicSource);\n            this.replaceSubCharacteristic(sc, inArrayProperty);\n            return true;\n        }\n        return false;\n    }\n    updateSecondaryComponentSubCharacteristic(familyName, subCharacteristicSource, dependencyName, secondaryComponentIndex=0)\n    {\n        return this.updateSubCharacteristic(familyName, subCharacteristicSource, dependencyName, this.secondaryComponents[secondaryComponentIndex].subCharacteristics);\n    }\n\n    /**\n     * Permet d'enregistrer le dessin SVG.JS d'une image pour éviter de la redessiner à chaque fois\n     */\n    setStrataImage(strataImage) {\n        this.strataImage = strataImage;\n    }\n\n    getStrataImage() {\n        return this.strataImage;\n    }\n\n    setInterfaceImage(interfaceImage) {\n        this.interfaceImage = interfaceImage;\n    }\n\n    getInterfaceImage() {\n        return this.interfaceImage;\n    }\n\n\n    /**\n     * Cette méthode initialise la strate en ajoutant à un tableau les propriétés modifiables\n     * et en lui attribuant des valeurs par défaut\n     */\n    init() {\n\n        this.addDependency('thicknessFamily');\n        this.addDependency('widthFamily');\n        this.addDependency('continuityFamily');\n        this.addDependency('directionFamily');\n\n        //Les strates CM n'ont pas d'interface\n        if (this.nature != \"Corroded metal\") {\n            this.addDependency('interfaceprofileFamily');\n        }\n\n        if (this.nature == \"Soil\") {\n\n            this.addDependency('colourFamily');\n            this.addDependency('brightnessFamily');\n            this.addDependency('opacityFamily');\n            this.addDependency('magnetismFamily');\n            this.addDependency('porosityFamily');\n            this.addDependency('cohesionFamily');\n            this.addDependency('hardnessFamily');\n            this.addDependency('crackingFamily');\n            this.addDependency('scompositionFamily');\n            this.addDependency('interfacetransitionFamily');\n            this.addDependency('interfaceroughnessFamily');\n            this.addDependency('interfaceadherenceFamily');\n        }\n\n        if (this.nature == \"Non-Metallic material\") {\n            this.addDependency('colourFamily');\n            this.addDependency('brightnessFamily');\n            this.addDependency('opacityFamily');\n            this.addDependency('magnetismFamily');\n            this.addDependency('porosityFamily');\n            this.addDependency('cohesionFamily');\n            this.addDependency('hardnessFamily');\n            this.addDependency('crackingFamily');\n            this.addDependency('nmmcompositionFamily');\n            this.addDependency('interfacetransitionFamily');\n            this.addDependency('interfaceroughnessFamily');\n            this.addDependency('interfaceadherenceFamily');\n        }\n\n\n        if (this.nature == \"Deposit\") {\n\n            this.addDependency('colourFamily');\n            this.addDependency('brightnessFamily');\n            this.addDependency('opacityFamily');\n            this.addDependency('magnetismFamily');\n            this.addDependency('porosityFamily');\n            this.addDependency('cohesionFamily');\n            this.addDependency('hardnessFamily');\n            this.addDependency('crackingFamily');\n            this.addDependency('dcompositionFamily');\n            this.addDependency('interfacetransitionFamily');\n            this.addDependency('interfaceroughnessFamily');\n            this.addDependency('interfaceadherenceFamily');\n        }\n\n        if (this.nature == \"Pseudomorph of organic material\") {\n            this.addDependency('colourFamily');\n            this.addDependency('brightnessFamily');\n            this.addDependency('opacityFamily');\n            this.addDependency('magnetismFamily');\n            this.addDependency('porosityFamily');\n            this.addDependency('cohesionFamily');\n            this.addDependency('hardnessFamily');\n            this.addDependency('crackingFamily');\n            this.addDependency('pomcompositionFamily');\n            this.addDependency('interfacetransitionFamily');\n            this.addDependency('interfaceroughnessFamily');\n            this.addDependency('interfaceadherenceFamily');\n        }\n\n        if (this.nature == \"Corrosion products\") {\n            this.addDependency('colourFamily');\n            this.addDependency('brightnessFamily');\n            this.addDependency('opacityFamily');\n            this.addDependency('magnetismFamily');\n            this.addDependency('porosityFamily');\n            this.addDependency('cprimicrostructureFamily');\n            this.addDependency('cohesionFamily');\n            this.addDependency('hardnessFamily');\n            this.addDependency('crackingFamily');\n            this.addDependency('interfacetransitionFamily');\n            this.addDependency('interfaceroughnessFamily');\n            this.addDependency('interfaceadherenceFamily');\n            this.addDependency('cpcompositionextensionFamily');\n            this.addDependency('cprimicrostructureaggregatecompositionFamily');\n            this.addDependency('cprimicrostructureaggregatecompositionextensionFamily');\n            this.addDependency('cpcompositionFamily');\n            this.addDependency('subcpcompositionFamily');\n            this.addDependency('subsubcpcompositionFamily');\n            this.addDependency('subcprimicrostructureFamily');\n            this.addDependency('subcprimicrostructureaggregatecompositionFamily');\n            this.addDependency('subsubcprimicrostructureaggregatecompositionFamily');\n        }\n\n        if (this.nature == \"Metal\") {\n\n            this.addDependency('colourFamily');\n            this.addDependency('brightnessFamily');\n            this.addDependency('opacityFamily');\n            this.addDependency('magnetismFamily');\n            this.addDependency('porosityFamily');\n            this.addDependency('mmicrostructureFamily');\n            this.addDependency('cohesionFamily');\n            this.addDependency('hardnessFamily');\n            this.addDependency('crackingFamily');\n            this.addDependency('mcompositionFamily');\n            this.addDependency('interfacetransitionFamily');\n            this.addDependency('interfaceroughnessFamily');\n            this.addDependency('interfaceadherenceFamily');\n            this.addDependency('submmicrostructureFamily');\n            this.addDependency('submcompositionFamily');\n        }\n\n\n    }\n\n    toJson() {\n        var childStrata = [],i;\n\n        var jsonStrata = {name: this.getUid(), characteristics: [], interfaces: [], children: [], secondaryComponents:[]};\n\n        //On récupère les caractéristiques\n        for (i = 0; i < this.characteristics.length; i++) {\n            if (!this.characteristics[i].isInterface()) {\n                jsonStrata.characteristics.push({name: this.characteristics[i].getName()});\n            }\n        }\n        //On récupère les sous caractéristiques\n        for (i = 0; i < this.subCharacteristics.length; i++) {\n            jsonStrata.characteristics.push({name: this.subCharacteristics[i].getUid()});\n        }\n\n        //On récupère les caractéristiques d'interface\n        for (i = 0; i < this.characteristics.length; i++) {\n            if (this.characteristics[i].isInterface()) {\n                jsonStrata.interfaces.push({name: this.characteristics[i].getName()});\n            }\n        }\n\n        //On récupère les strates enfants si ce n'est pas une strate enfant\n        if (!this.child) {\n            for (i = 0; i < this.childStrata.length; i++) {\n                jsonStrata.children.push(this.childStrata[i].toJson());\n            }\n        }\n        // secondaryComponents\n        for (let sc of this.secondaryComponents) {\n            let all_component_characteristics = sc.characteristics.map(c => ({name: c.getName()})\n            ).concat(sc.subCharacteristics.map(sc => ({name: sc.getUid()})));\n            if (all_component_characteristics.length)\n                jsonStrata.secondaryComponents.push(all_component_characteristics);\n        }\n        return jsonStrata;\n\n    }\n\n\n}\n\nexport {Strata};\n"]}